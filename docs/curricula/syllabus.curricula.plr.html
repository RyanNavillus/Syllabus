<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Self Play Curricula" href="syllabus.curricula.selfplay.html" /><link rel="prev" title="Learning Progress" href="syllabus.curricula.learning_progress.html" />

    <!-- Generated with Sphinx 7.0.1 and Furo 2023.05.20 -->
        <title>Prioritized Level Replay - Syllabus 0.6 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Syllabus 0.6 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Syllabus 0.6 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../motivation.html">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../environments.html">Environment Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluation/evaluation.html">Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Curriculum API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/syllabus.core.curriculum.html">Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_curricula.html">Creating Your Own Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="co_player.html">Co-player Curricula</a></li>
<li class="toctree-l1"><a class="reference internal" href="implemented_curricula.html">Curriculum Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../evaluators.html">Evaluators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stat_recorder.html">Stat Recorder</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Curriculum Methods:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="syllabus.curricula.annealing.html">Simulated Annealing</a></li>
<li class="toctree-l1"><a class="reference internal" href="syllabus.curricula.constant.html">Constant Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="syllabus.curricula.domain_randomization.html">Domain Randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="syllabus.curricula.expanding_box.html">Expanding Box Curriculum</a></li>
<li class="toctree-l1"><a class="reference internal" href="syllabus.curricula.learning_progress.html">Learning Progress</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Prioritized Level Replay</a></li>
<li class="toctree-l1"><a class="reference internal" href="syllabus.curricula.selfplay.html">Self Play Curricula</a></li>
<li class="toctree-l1"><a class="reference internal" href="syllabus.curricula.sequential.html">Sequential Curriculum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Task Spaces:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/syllabus.task_space.html">Task Spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/syllabus.core.task_interface.html">Task Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/syllabus.examples.task_wrappers.html">Task Wrappers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Synchronization:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules/syllabus.core.html">Global Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../synchronization/curriculum_synchronization.html">Curriculum Synchronization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../synchronization/environment_synchronization.html">Environment Synchronization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/RyanNavillus/Syllabus">Github</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/modules.html">syllabus</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of syllabus</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../modules/syllabus.html">syllabus package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of syllabus package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/syllabus.core.html">Global Synchronization</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../modules/syllabus.examples.html">Examples</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Examples</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/syllabus.examples.models.html">Example Models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/syllabus.examples.task_wrappers.html">Task Wrappers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/syllabus.examples.utils.html">Example Utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/syllabus.task_space.html">Task Spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/syllabus.tests.html">syllabus.tests package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/syllabus.curricula.html">Curricula</a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="prioritized-level-replay">
<span id="id1"></span><h1>Prioritized Level Replay<a class="headerlink" href="#prioritized-level-replay" title="Permalink to this heading">#</a></h1>
<p>A curriculum learning method that estimates an agent’s regret on particular environment seed and uses a prioritized replay buffer to replay levels for which the agent has high regret. This implementation is based on the open-source original implementation at <a class="reference external" href="https://github.com/facebookresearch/level-replay">https://github.com/facebookresearch/level-replay</a>, but has been modified to support Syllabus task spaces instead of just environment seeds. PLR has been used in multiple prominent RL works, such as <a class="reference external" href="https://arxiv.org/abs/2301.07608">Human-Timescale Adaptation in an Open-Ended Task Space</a>. For more information you can read the original paper <a class="reference external" href="https://arxiv.org/abs/2010.03934.pdf">Prioritized Level Replay (Jiang et al. 2021)</a>.</p>
<p>Prioritized Level Replay  samples the next training level by prioritizing those with a higher estimated learning potential. The paper proposes multiple metrics for measuring learning progress, but suggest L1 Value loss or equivalently the Generalized Advantage Estimation (GAE) magnitude as the most effective metric. PLR also utilizes a staleness metric to ensure that every task’s learning progress is occasionally updated based on the current policy’s capabilities.</p>
<p>In practice prioritized level replay updates it’s sampling distribution after each batch, and samples the single highest learning potential task with very high probability. The sampling temperature and task diversity can can be increased by raising the <code class="docutils literal notranslate"><span class="pre">temperature</span></code> argument.</p>
<p>The default hyperparameters are tuned for Procgen. When applying PLR to a new environment, you may want to tune the <code class="docutils literal notranslate"><span class="pre">staleness_coef</span></code>, the replay probability <code class="docutils literal notranslate"><span class="pre">rho</span></code>, or alter the number of training seeds. You can change the number of training tasks by modifying your task space.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h2>
<p>PLR expects the environment to be deterministic with respect to the task, which is typically the seed. You may not see good results if your environment is not deterministic for a given task. You can check if your environment is deterministic by modifying the determinism_tests script here <a class="reference external" href="https://github.com/RyanNavillus/Syllabus/blob/main/tests/determinism_tests.py">https://github.com/RyanNavillus/Syllabus/blob/main/tests/determinism_tests.py</a> to use your environment.</p>
<p>To initialize the curriculum, you will also need to provide the <code class="docutils literal notranslate"><span class="pre">num_processes</span></code> which is the number of parallel environments. If you are using Generalized Advantage Estimation, you need to pass the same <code class="docutils literal notranslate"><span class="pre">num_steps</span></code>, <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, and <code class="docutils literal notranslate"><span class="pre">gae_lambda</span></code> arguments that you use in your training process. You can set any PLR algorithmic options in the <code class="docutils literal notranslate"><span class="pre">task_sampler_kwargs_dict</span></code>. Please see the <a class="reference internal" href="#tasksampler"><span class="std std-ref">TaskSampler</span></a> for a full list of options.</p>
<p>PLR requires L1 Value estimates from the training process to compute it’s sampling distribution, and Syllabus provides several different ways to achieve this, each with its own pros and cons. In short:</p>
<ul class="simple">
<li><p><strong>PrioritizedLevelReplay</strong> - This is the simplest way to add PLR to a project. It receives step updates from the environments and uses an evaluator to recompute the values for each step. This allows you to use it without modifying the training code in any way, but also means it is duplicating a lot of computation.</p></li>
<li><p><strong>CentralPrioritizedLevelReplay</strong> - This version directly receives value predictions and other data from the training process, and uses them to compute scores.</p></li>
<li><p><strong>DirectPrioritizedLevelReplay</strong> - This method allows the user to directly provide the scores used in the sampling distribution. It provides the most control over the curriculum, but also has the highest potential for implementation errors.</p></li>
</ul>
<p>We recommend using <code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay</span></code> for initial experiments and tests, then transitioning to <code class="docutils literal notranslate"><span class="pre">CentralPrioritizedLevelReplay</span></code> or <code class="docutils literal notranslate"><span class="pre">DirectPrioritizedLevelReplay</span></code> for better performance. Since these have higher potential for implementation errors, you can compare their performance against a <code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay</span></code> baseline to check for discrepancies. Below we go into more detail into how each method operates, and how to configure them for your project.</p>
<p><strong>Note:</strong> we plan to merge these methods into a single class in the future.</p>
<p><strong>Note:</strong> the current implementation of <code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay</span></code> and <code class="docutils literal notranslate"><span class="pre">CentralPrioritizedLevelReplay</span></code> only support GAE returns. If you want to use a different return method, you can subclass these methods or use <code class="docutils literal notranslate"><span class="pre">DirectPrioritizedLevelReplay</span></code>.</p>
<section id="id2">
<h3>Prioritized Level Replay<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>This asynchronous implementation of PLR runs automatically with no direct changes to the training code. Once it is configured and the <a class="reference internal" href="../modules/syllabus.core.html#synchronization"><span class="std std-ref">synchronization wrappers</span></a> are applied, it will automatically begin sending high-priority tasks to the training environments. <code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay</span></code> requires an <a class="reference internal" href="../evaluators.html#evaluators"><span class="std std-ref">Evaluator</span></a> to get the value predictions used to calculate prioritization scores. This introduces some duplicate computation and in some cases can slow down training, especially in systems where agent inference is the bottleneck. If you need to train agents above 10,000 steps per second, we suggest looking at <code class="docutils literal notranslate"><span class="pre">CentralPrioritizedLevelReplay</span></code> or <code class="docutils literal notranslate"><span class="pre">DirectPrioritizedLevelReplay</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">buffer_size</span></code> argument to PLR defines how many multiples of <code class="docutils literal notranslate"><span class="pre">num_steps</span></code> should be allocated for PLR’s buffer. For instance, if the <code class="docutils literal notranslate"><span class="pre">num_steps</span></code> is 64 and <code class="docutils literal notranslate"><span class="pre">buffer_size</span></code> is 4, then PLR’s buffers will hold 256 total steps. PLR needs to hold extra data because in order to efficiently batch value predictions, it needs to evaluate values for all environments at once. However, due to the asynchronous updates, some environments may send multiple batches before other environments send any. This means that PLR may need to hold more than <code class="docutils literal notranslate"><span class="pre">num_steps</span></code> steps before it is able to collect values and update the <code class="docutils literal notranslate"><span class="pre">TaskSampler</span></code>. If one environment is running significantly slower than others, this may lead to an overflow error. If you encounter this issue, you can increase the <code class="docutils literal notranslate"><span class="pre">buffer_size</span></code> to hold more steps, or decrease the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> of your environment synchronization wrapper to increase the frequency of updates. Note that the <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> argument should never exceed the total buffer size, or the update will fail on the first insert. There are also several warnings and error messages in the code to help you diagnose these issues.</p>
<p>Below is an example of how you can set up <code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay</span></code> in your project.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">syllabus.curricula</span> <span class="kn">import</span> <span class="n">PrioritizedLevelReplay</span>
<span class="kn">from</span> <span class="nn">syllabus.evaluators</span> <span class="kn">import</span> <span class="n">CleanRLEvaluator</span>
<span class="kn">from</span> <span class="nn">syllabus.core</span> <span class="kn">import</span> <span class="n">GymnasiumSyncWrapper</span><span class="p">,</span> <span class="n">make_multiprocessing_curriculum</span>

<span class="c1"># Initialize the environment</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">Env</span><span class="p">()</span>

<span class="c1"># Create the Evaluator</span>
<span class="n">evaluator</span> <span class="o">=</span> <span class="n">CleanRLEvaluator</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>

<span class="c1"># Initialize the Curriculum</span>
<span class="n">curriculum</span> <span class="o">=</span> <span class="n">PrioritizedLevelReplay</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">task_space</span><span class="p">,</span> <span class="n">env</span><span class="o">.</span><span class="n">observation_space</span><span class="p">)</span>
<span class="n">curriculum</span> <span class="o">=</span> <span class="n">make_multiprocessing_curriculum</span><span class="p">(</span><span class="n">curriculum</span><span class="p">)</span>

<span class="c1"># Wrap the environment</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">GymnasiumSyncWrapper</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">curriculum</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
</pre></div>
</div>
<p>For a complete example using <code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay</span></code> with CleanRL’s PPO, see <a class="reference external" href="https://github.com/RyanNavillus/Syllabus/blob/main/syllabus/examples/training_scripts/cleanrl_procgen.py">https://github.com/RyanNavillus/Syllabus/blob/main/syllabus/examples/training_scripts/cleanrl_procgen.py</a>.</p>
<span class="target" id="module-syllabus.curricula.plr.plr_wrapper"></span><dl class="py class">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">syllabus.curricula.plr.plr_wrapper.</span></span><span class="sig-name descname"><span class="pre">PrioritizedLevelReplay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.DiscreteTaskSpace" title="syllabus.task_space.task_space.DiscreteTaskSpace"><span class="pre">DiscreteTaskSpace</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.MultiDiscreteTaskSpace" title="syllabus.task_space.task_space.MultiDiscreteTaskSpace"><span class="pre">MultiDiscreteTaskSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">curriculum_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_sampler_kwargs_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_minibatches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gae_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_usage_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../evaluators.html#syllabus.core.evaluator.Evaluator" title="syllabus.core.evaluator.Evaluator"><span class="pre">Evaluator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">curriculum_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#PrioritizedLevelReplay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../modules/syllabus.core.curriculum.html#syllabus.core.curriculum_base.Curriculum" title="syllabus.core.curriculum_base.Curriculum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Curriculum</span></code></a></p>
<p>Prioritized Level Replay (PLR) Curriculum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_space</strong> (<a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.TaskSpace" title="syllabus.task_space.task_space.TaskSpace"><em>TaskSpace</em></a>) – The task space to use for the curriculum.</p></li>
<li><p><strong>*curriculum_args</strong> – Positional arguments to pass to the curriculum.</p></li>
<li><p><strong>task_sampler_kwargs_dict</strong> (<em>dict</em>) – Keyword arguments to pass to the task sampler. See TaskSampler for details.</p></li>
<li><p><strong>action_space</strong> (<em>gym.Space</em>) – The action space to use for the curriculum. Required for some strategies.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device to use to store curriculum data, either “cpu” or “cuda”.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em>) – The number of steps to store in the rollouts.</p></li>
<li><p><strong>num_processes</strong> (<em>int</em>) – The number of parallel environments.</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – The discount factor used to compute returns</p></li>
<li><p><strong>gae_lambda</strong> (<em>float</em>) – The GAE lambda value.</p></li>
<li><p><strong>suppress_usage_warnings</strong> (<em>bool</em>) – Whether to suppress warnings about improper usage.</p></li>
<li><p><strong>**curriculum_kwargs</strong> – Keyword arguments to pass to the curriculum.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.log_metrics">
<span class="sig-name descname"><span class="pre">log_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_tasks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#PrioritizedLevelReplay.log_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.log_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Log the task distribution to the provided tensorboard writer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.requires_step_updates">
<span class="sig-name descname"><span class="pre">requires_step_updates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#PrioritizedLevelReplay.requires_step_updates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.requires_step_updates" title="Permalink to this definition">#</a></dt>
<dd><p>Returns whether the curriculum requires step updates from the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the curriculum requires step updates, False otherwise</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#PrioritizedLevelReplay.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Sample k tasks from the curriculum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> – Number of tasks to sample, defaults to 1</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either returns a single task if k=1, or a list of k tasks</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.update_on_step">
<span class="sig-name descname"><span class="pre">update_on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">term</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#PrioritizedLevelReplay.update_on_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.update_on_step" title="Permalink to this definition">#</a></dt>
<dd><p>Update the curriculum with the current step results from the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.update_on_step_batch">
<span class="sig-name descname"><span class="pre">update_on_step_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_results</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#PrioritizedLevelReplay.update_on_step_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.update_on_step_batch" title="Permalink to this definition">#</a></dt>
<dd><p>Update the curriculum with a batch of step results from the environment.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">syllabus.curricula.plr.plr_wrapper.</span></span><span class="sig-name descname"><span class="pre">RolloutStorage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_value_buffers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_minibatches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buffer_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gae_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../evaluators.html#syllabus.core.evaluator.Evaluator" title="syllabus.core.evaluator.Evaluator"><span class="pre">Evaluator</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#RolloutStorage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage.after_update">
<span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#RolloutStorage.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.after_update" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage.compute_returns">
<span class="sig-name descname"><span class="pre">compute_returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gae_lambda</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#RolloutStorage.compute_returns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.compute_returns" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage.get_index">
<span class="sig-name descname"><span class="pre">get_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#RolloutStorage.get_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.get_index" title="Permalink to this definition">#</a></dt>
<dd><p>Map the environment ids to indices in the buffer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage.get_value_predictions">
<span class="sig-name descname"><span class="pre">get_value_predictions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#RolloutStorage.get_value_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.get_value_predictions" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage.insert_at_index">
<span class="sig-name descname"><span class="pre">insert_at_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#RolloutStorage.insert_at_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.insert_at_index" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/plr_wrapper.html#RolloutStorage.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.to" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="syllabus.curricula.plr.plr_wrapper.RolloutStorage.using_lstm">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">using_lstm</span></span><a class="headerlink" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.using_lstm" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="central-prioritized-level-replay">
<h3>Central Prioritized Level Replay<a class="headerlink" href="#central-prioritized-level-replay" title="Permalink to this heading">#</a></h3>
<p>This version of PLR does not require an evaluator but does require additional code to send data from the training loop to the curriculum. Below you can find examples of how to do this for some of the popular RL frameworks.</p>
<div class="sphinx-tabs docutils container" id="prioritized-level-replay-update">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">CleanRL</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Stable Baselines 3</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">RLLib</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p>Insert the following code at the end of the step loop. For example, <a class="reference external" href="https://github.com/vwxyzjn/cleanrl/blob/e421c2e50b81febf639fced51a69e2602593d50d/cleanrl/ppo.py#L216">at line 216 in ppo.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">num_steps</span><span class="p">):</span>
   <span class="o">...</span>

   <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
      <span class="n">next_value</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="n">next_obs</span><span class="p">)</span>
   <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;task&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">infos</span><span class="p">]</span>

   <span class="n">update</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">,</span>
      <span class="s2">&quot;next_value&quot;</span><span class="p">:</span> <span class="n">next_value</span><span class="p">,</span>
      <span class="s2">&quot;rew&quot;</span><span class="p">:</span> <span class="n">reward</span><span class="p">,</span>
      <span class="s2">&quot;dones&quot;</span><span class="p">:</span> <span class="n">done</span><span class="p">,</span>
      <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="n">tasks</span><span class="p">,</span>
   <span class="p">}</span>
   <span class="n">curriculum</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p>You can use a callback to send the values to the curriculum. The callback should be added to the <code class="docutils literal notranslate"><span class="pre">learn</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PLRCallback</span><span class="p">(</span><span class="n">BaseCallback</span><span class="p">):</span>
   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">curriculum</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
      <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">verbose</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">curriculum</span> <span class="o">=</span> <span class="n">curriculum</span>

   <span class="k">def</span> <span class="nf">_on_step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
      <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;task&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locals</span><span class="p">[</span><span class="s2">&quot;infos&quot;</span><span class="p">]]</span>

      <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">locals</span><span class="p">[</span><span class="s1">&#39;new_obs&#39;</span><span class="p">]</span>
      <span class="n">obs_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
      <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
         <span class="n">new_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">predict_values</span><span class="p">(</span><span class="n">obs_tensor</span><span class="p">)</span>

      <span class="n">update</span> <span class="o">=</span> <span class="p">{</span>
         <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">locals</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">],</span>
         <span class="s2">&quot;next_value&quot;</span><span class="p">:</span> <span class="n">new_value</span><span class="p">,</span>
         <span class="s2">&quot;rew&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">locals</span><span class="p">[</span><span class="s2">&quot;rewards&quot;</span><span class="p">],</span>
         <span class="s2">&quot;dones&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">locals</span><span class="p">[</span><span class="s2">&quot;dones&quot;</span><span class="p">],</span>
         <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="n">tasks</span><span class="p">,</span>
      <span class="p">}</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">curriculum</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
      <span class="k">return</span> <span class="kc">True</span>

<span class="n">curriculum</span> <span class="o">=</span> <span class="n">PrioritizedLevelReplay</span><span class="p">(</span><span class="n">task_space</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">CustomCallback</span><span class="p">(</span><span class="n">curriculum</span><span class="p">))</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><p>The exact code will depend on your version of RLLib, but you can use callbacks similar to Stable Baselines 3 to update the curriculum after each step <a class="reference external" href="https://docs.ray.io/en/latest/rllib/rllib-advanced-api.html#rllib-advanced-api-doc">https://docs.ray.io/en/latest/rllib/rllib-advanced-api.html#rllib-advanced-api-doc</a>.</p>
</div></div>
<span class="target" id="module-syllabus.curricula.plr.central_plr_wrapper"></span><dl class="py class">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">syllabus.curricula.plr.central_plr_wrapper.</span></span><span class="sig-name descname"><span class="pre">CentralPrioritizedLevelReplay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.DiscreteTaskSpace" title="syllabus.task_space.task_space.DiscreteTaskSpace"><span class="pre">DiscreteTaskSpace</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.MultiDiscreteTaskSpace" title="syllabus.task_space.task_space.MultiDiscreteTaskSpace"><span class="pre">MultiDiscreteTaskSpace</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">curriculum_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_sampler_kwargs_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gae_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_usage_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">curriculum_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#CentralPrioritizedLevelReplay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../modules/syllabus.core.curriculum.html#syllabus.core.curriculum_base.Curriculum" title="syllabus.core.curriculum_base.Curriculum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Curriculum</span></code></a></p>
<p>Prioritized Level Replay (PLR) Curriculum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_space</strong> (<a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.TaskSpace" title="syllabus.task_space.task_space.TaskSpace"><em>TaskSpace</em></a>) – The task space to use for the curriculum.</p></li>
<li><p><strong>*curriculum_args</strong> – Positional arguments to pass to the curriculum.</p></li>
<li><p><strong>task_sampler_kwargs_dict</strong> (<em>dict</em>) – Keyword arguments to pass to the task sampler. See TaskSampler for details.</p></li>
<li><p><strong>action_space</strong> (<em>gym.Space</em>) – The action space to use for the curriculum. Required for some strategies.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device to use to store curriculum data, either “cpu” or “cuda”.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em>) – The number of steps to store in the rollouts.</p></li>
<li><p><strong>num_processes</strong> (<em>int</em>) – The number of parallel environments.</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – The discount factor used to compute returns</p></li>
<li><p><strong>gae_lambda</strong> (<em>float</em>) – The GAE lambda value.</p></li>
<li><p><strong>suppress_usage_warnings</strong> (<em>bool</em>) – Whether to suppress warnings about improper usage.</p></li>
<li><p><strong>**curriculum_kwargs</strong> – Keyword arguments to pass to the curriculum.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.log_metrics">
<span class="sig-name descname"><span class="pre">log_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_tasks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#CentralPrioritizedLevelReplay.log_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.log_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Log the task distribution to the provided tensorboard writer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#CentralPrioritizedLevelReplay.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Sample k tasks from the curriculum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> – Number of tasks to sample, defaults to 1</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either returns a single task if k=1, or a list of k tasks</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#CentralPrioritizedLevelReplay.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the curriculum with arbitrary inputs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.RolloutStorage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">syllabus.curricula.plr.central_plr_wrapper.</span></span><span class="sig-name descname"><span class="pre">RolloutStorage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_value_buffers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#RolloutStorage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.after_update">
<span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#RolloutStorage.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.after_update" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.compute_returns">
<span class="sig-name descname"><span class="pre">compute_returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gae_lambda</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#RolloutStorage.compute_returns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.compute_returns" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.get_idxs">
<span class="sig-name descname"><span class="pre">get_idxs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_ids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#RolloutStorage.get_idxs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.get_idxs" title="Permalink to this definition">#</a></dt>
<dd><p>Map the environment ids to indices in the buffer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_log_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_preds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rewards</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tasks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#RolloutStorage.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.insert" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/central_plr_wrapper.html#RolloutStorage.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.to" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="direct-prioritized-level-replay">
<h3>Direct Prioritized Level Replay<a class="headerlink" href="#direct-prioritized-level-replay" title="Permalink to this heading">#</a></h3>
<p>This implementation of PLR allows you to directly compute your own scores used to prioritize tasks. This gives you the most control over the curriculum, but it can be tricky to implement a good scoring function. Below is an example of how to implement the Value L1 score in CleanRL’s PPO. The full script can be found here <a class="reference external" href="https://github.com/RyanNavillus/Syllabus/blob/main/syllabus/examples/training_scripts/cleanrl_procgen.py">https://github.com/RyanNavillus/Syllabus/blob/main/syllabus/examples/training_scripts/cleanrl_procgen.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">returns</span><span class="o">.</span><span class="n">shape</span>
<span class="n">new_returns</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="n">new_returns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">returns</span>
<span class="n">new_values</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
<span class="n">new_values</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">values</span>
<span class="n">new_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">next_value</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_returns</span> <span class="o">-</span> <span class="n">new_values</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="n">curriculum</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">tasks</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">dones</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tasks</span></code> and <code class="docutils literal notranslate"><span class="pre">dones</span></code> arrays have the shape <code class="docutils literal notranslate"><span class="pre">(num_steps,</span> <span class="pre">num_envs)</span></code> and the <code class="docutils literal notranslate"><span class="pre">scores</span></code> array has the shape <code class="docutils literal notranslate"><span class="pre">(num_steps</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">num_envs)</span></code>. We need to expand the size of the value tensor to include the next value prediction, and the returns tensor to match. In some versions of PLR, the next values are also added to the final index of the returns tensor. This effectively removes the next values from the Value L1 score calculation, but allows them to still be used for GAE.</p>
<span class="target" id="module-syllabus.curricula.plr.direct_plr_wrapper"></span><dl class="py class">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">syllabus.curricula.plr.direct_plr_wrapper.</span></span><span class="sig-name descname"><span class="pre">DirectPrioritizedLevelReplay</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.DiscreteTaskSpace" title="syllabus.task_space.task_space.DiscreteTaskSpace"><span class="pre">DiscreteTaskSpace</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.MultiDiscreteTaskSpace" title="syllabus.task_space.task_space.MultiDiscreteTaskSpace"><span class="pre">MultiDiscreteTaskSpace</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">curriculum_args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_sampler_kwargs_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_usage_warnings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">curriculum_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#DirectPrioritizedLevelReplay"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../modules/syllabus.core.curriculum.html#syllabus.core.curriculum_base.Curriculum" title="syllabus.core.curriculum_base.Curriculum"><code class="xref py py-class docutils literal notranslate"><span class="pre">Curriculum</span></code></a></p>
<p>Prioritized Level Replay (PLR) Curriculum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_space</strong> (<a class="reference internal" href="../modules/syllabus.task_space.html#syllabus.task_space.task_space.TaskSpace" title="syllabus.task_space.task_space.TaskSpace"><em>TaskSpace</em></a>) – The task space to use for the curriculum.</p></li>
<li><p><strong>*curriculum_args</strong> – Positional arguments to pass to the curriculum.</p></li>
<li><p><strong>task_sampler_kwargs_dict</strong> (<em>dict</em>) – Keyword arguments to pass to the task sampler. See TaskSampler for details.</p></li>
<li><p><strong>action_space</strong> (<em>gym.Space</em>) – The action space to use for the curriculum. Required for some strategies.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device to use to store curriculum data, either “cpu” or “cuda”.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em>) – The number of steps to store in the rollouts.</p></li>
<li><p><strong>num_processes</strong> (<em>int</em>) – The number of parallel environments.</p></li>
<li><p><strong>suppress_usage_warnings</strong> (<em>bool</em>) – Whether to suppress warnings about improper usage.</p></li>
<li><p><strong>**curriculum_kwargs</strong> – Keyword arguments to pass to the curriculum.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.log_metrics">
<span class="sig-name descname"><span class="pre">log_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_n_tasks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#DirectPrioritizedLevelReplay.log_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.log_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Log the task distribution to the provided tensorboard writer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#DirectPrioritizedLevelReplay.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.sample" title="Permalink to this definition">#</a></dt>
<dd><p>Sample k tasks from the curriculum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> – Number of tasks to sample, defaults to 1</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either returns a single task if k=1, or a list of k tasks</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#DirectPrioritizedLevelReplay.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.update" title="Permalink to this definition">#</a></dt>
<dd><p>Update the curriculum with arbitrary inputs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">syllabus.curricula.plr.direct_plr_wrapper.</span></span><span class="sig-name descname"><span class="pre">RolloutStorage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_processes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#RolloutStorage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.after_update">
<span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#RolloutStorage.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.after_update" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#RolloutStorage.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.insert" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.ready">
<span class="sig-name descname"><span class="pre">ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#RolloutStorage.ready"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.ready" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/direct_plr_wrapper.html#RolloutStorage.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.to" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="task-sampler">
<h3>Task Sampler<a class="headerlink" href="#task-sampler" title="Permalink to this heading">#</a></h3>
<p>The task sampler is shared between the different PLR implementations. It is responsible for calculating and tracking scores, and sampling tasks. It has many different options for sampling strategies that can be configured by passing the <code class="docutils literal notranslate"><span class="pre">task_sampler_kwargs</span></code> dictionary to PLR’s initializer.</p>
<span class="target" id="module-syllabus.curricula.plr.task_sampler"><span id="tasksampler"></span></span><dl class="py class">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">syllabus.curricula.plr.task_sampler.</span></span><span class="sig-name descname"><span class="pre">TaskSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tasks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Space</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_actors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'value_l1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replay_schedule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'proportionate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rank'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">staleness_coef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">staleness_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'power'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">staleness_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/task_sampler.html#TaskSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Task sampler for Prioritized Level Replay (PLR)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tasks</strong> (<em>list</em>) – List of tasks to sample from</p></li>
<li><p><strong>action_space</strong> (<em>gym.spaces.Space</em>) – Action space of the environment</p></li>
<li><p><strong>num_actors</strong> (<em>int</em>) – Number of actors/processes</p></li>
<li><p><strong>strategy</strong> (<em>str</em>) – Strategy for sampling tasks. One of “value_l1”, “gae”, “policy_entropy”, “least_confidence”, “min_margin”, “one_step_td_error”.</p></li>
<li><p><strong>replay_schedule</strong> (<em>str</em>) – Schedule for sampling replay levels. One of “fixed” or “proportionate”.</p></li>
<li><p><strong>score_transform</strong> (<em>str</em>) – Transform to apply to task scores. One of “constant”, “max”, “eps_greedy”, “rank”, “power”, “softmax”.</p></li>
<li><p><strong>temperature</strong> (<em>float</em>) – Temperature for score transform. Increasing temperature makes the sampling distribution more uniform.</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Epsilon for eps-greedy score transform.</p></li>
<li><p><strong>rho</strong> (<em>float</em>) – Proportion of seen tasks before replay sampling is allowed.</p></li>
<li><p><strong>nu</strong> (<em>float</em>) – Probability of sampling a replay level if using a fixed replay_schedule.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Linear interpolation weight for score updates. 0.0 means only use old scores, 1.0 means only use new scores.</p></li>
<li><p><strong>staleness_coef</strong> (<em>float</em>) – Linear interpolation weight for task staleness vs. task score. 0.0 means only use task score, 1.0 means only use staleness.</p></li>
<li><p><strong>staleness_transform</strong> (<em>str</em>) – Transform to apply to task staleness. One of “constant”, “max”, “eps_greedy”, “rank”, “power”, “softmax”.</p></li>
<li><p><strong>staleness_temperature</strong> (<em>float</em>) – Temperature for staleness transform. Increasing temperature makes the sampling distribution more uniform.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler.after_update">
<span class="sig-name descname"><span class="pre">after_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actor_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/task_sampler.html#TaskSampler.after_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler.after_update" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/task_sampler.html#TaskSampler.metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler.metrics" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler.requires_value_buffers">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">requires_value_buffers</span></span><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler.requires_value_buffers" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/task_sampler.html#TaskSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler.sample" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler.sample_weights">
<span class="sig-name descname"><span class="pre">sample_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/task_sampler.html#TaskSampler.sample_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler.sample_weights" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler.update_task_score">
<span class="sig-name descname"><span class="pre">update_task_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actor_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/task_sampler.html#TaskSampler.update_task_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler.update_task_score" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="syllabus.curricula.plr.task_sampler.TaskSampler.update_with_rollouts">
<span class="sig-name descname"><span class="pre">update_with_rollouts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rollouts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actor_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/syllabus/curricula/plr/task_sampler.html#TaskSampler.update_with_rollouts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#syllabus.curricula.plr.task_sampler.TaskSampler.update_with_rollouts" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="syllabus.curricula.selfplay.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Self Play Curricula</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="syllabus.curricula.learning_progress.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Learning Progress</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Ryan Sullivan
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Prioritized Level Replay</a><ul>
<li><a class="reference internal" href="#usage">Usage</a><ul>
<li><a class="reference internal" href="#id2">Prioritized Level Replay</a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay"><code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay</span></code></a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.log_metrics"><code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay.log_metrics()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.requires_step_updates"><code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay.requires_step_updates()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.sample"><code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay.sample()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.update_on_step"><code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay.update_on_step()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.PrioritizedLevelReplay.update_on_step_batch"><code class="docutils literal notranslate"><span class="pre">PrioritizedLevelReplay.update_on_step_batch()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage"><code class="docutils literal notranslate"><span class="pre">RolloutStorage</span></code></a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.after_update"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.after_update()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.compute_returns"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.compute_returns()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.get_index"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.get_index()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.get_value_predictions"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.get_value_predictions()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.insert_at_index"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.insert_at_index()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.to"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.to()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.plr_wrapper.RolloutStorage.using_lstm"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.using_lstm</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#central-prioritized-level-replay">Central Prioritized Level Replay</a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay"><code class="docutils literal notranslate"><span class="pre">CentralPrioritizedLevelReplay</span></code></a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.log_metrics"><code class="docutils literal notranslate"><span class="pre">CentralPrioritizedLevelReplay.log_metrics()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.sample"><code class="docutils literal notranslate"><span class="pre">CentralPrioritizedLevelReplay.sample()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.CentralPrioritizedLevelReplay.update"><code class="docutils literal notranslate"><span class="pre">CentralPrioritizedLevelReplay.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage"><code class="docutils literal notranslate"><span class="pre">RolloutStorage</span></code></a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.after_update"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.after_update()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.compute_returns"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.compute_returns()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.get_idxs"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.get_idxs()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.insert"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.insert()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.central_plr_wrapper.RolloutStorage.to"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.to()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#direct-prioritized-level-replay">Direct Prioritized Level Replay</a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay"><code class="docutils literal notranslate"><span class="pre">DirectPrioritizedLevelReplay</span></code></a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.log_metrics"><code class="docutils literal notranslate"><span class="pre">DirectPrioritizedLevelReplay.log_metrics()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.sample"><code class="docutils literal notranslate"><span class="pre">DirectPrioritizedLevelReplay.sample()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.DirectPrioritizedLevelReplay.update"><code class="docutils literal notranslate"><span class="pre">DirectPrioritizedLevelReplay.update()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage"><code class="docutils literal notranslate"><span class="pre">RolloutStorage</span></code></a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.after_update"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.after_update()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.insert"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.insert()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.ready"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.ready()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.direct_plr_wrapper.RolloutStorage.to"><code class="docutils literal notranslate"><span class="pre">RolloutStorage.to()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#task-sampler">Task Sampler</a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler"><code class="docutils literal notranslate"><span class="pre">TaskSampler</span></code></a><ul>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler.after_update"><code class="docutils literal notranslate"><span class="pre">TaskSampler.after_update()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler.metrics"><code class="docutils literal notranslate"><span class="pre">TaskSampler.metrics()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler.requires_value_buffers"><code class="docutils literal notranslate"><span class="pre">TaskSampler.requires_value_buffers</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler.sample"><code class="docutils literal notranslate"><span class="pre">TaskSampler.sample()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler.sample_weights"><code class="docutils literal notranslate"><span class="pre">TaskSampler.sample_weights()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler.update_task_score"><code class="docutils literal notranslate"><span class="pre">TaskSampler.update_task_score()</span></code></a></li>
<li><a class="reference internal" href="#syllabus.curricula.plr.task_sampler.TaskSampler.update_with_rollouts"><code class="docutils literal notranslate"><span class="pre">TaskSampler.update_with_rollouts()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/tabs.js"></script>
    </body>
</html>